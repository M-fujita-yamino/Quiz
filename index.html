// --- 修正版：音声を合成して鳴らす関数 ---

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(type) {
    const oscillator = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    if (type === 'correct') {
        // ピンポーン（高い音を2回）
        oscillator.type = 'sine';
        oscillator.frequency.setValueAtTime(880, audioCtx.currentTime); // ラ
        oscillator.frequency.setValueAtTime(1108, audioCtx.currentTime + 0.1); // チ
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 0.5);
    } else {
        // ブブー（低い音を1回）
        oscillator.type = 'sawtooth';
        oscillator.frequency.setValueAtTime(150, audioCtx.currentTime); 
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 0.3);
    }
}

// --- 判定ロジックの中身を書き換え ---
recognition.onresult = (event) => {
    // (中略)
    if (isCorrect) {
        playSound('correct'); // 書き換え
        // (正解の表示処理)
    } else {
        playSound('wrong');   // 書き換え
        // (不正解の表示処理)
    }
};
